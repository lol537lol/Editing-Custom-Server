{"version":3,"file":"authUtils.js","sourceRoot":"","sources":["../../ts/server/authUtils.ts"],"names":[],"mappings":"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"}